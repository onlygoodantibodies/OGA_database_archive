{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OGA Academy – Your Modules</title>
    <link rel="icon" type="image/x-icon" href="{% static 'core/up-logo.ico' %}">

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'core/styles.css' %}">
    <link rel="stylesheet" href="{% static 'academy/css/style.css' %}">
    <style>
      .module-header {
        font-size: 1.6rem;
        font-weight: 700;
        color: #10428a;
        margin-bottom: 0.3rem;
        text-align: left;
      }
    </style>
</head>
<body class="no-wobble">

    {% include 'core/cookie_banner.html' %}
    <script src="{% static 'core/script.js' %}"></script>

    <header class="header">
      <div class="logo">
        <a href="{% url 'home' %}">
          <img src="{% static 'core/logo.png' %}" alt="Logo" class="logo-img">
        </a>
      </div>
      <div class="hamburger">☰</div>
      <nav>
        <ul class="menu">
          <li><a href="{% url 'academy:academy_home' %}">Home</a></li>
          <li><a href="{% url 'about' %}">About Us</a></li>
          <li><a href="{% url 'publications' %}">Publications</a></li>
          <li><a href="{% url 'partners' %}">Partners</a></li>
          <li><a href="{% url 'contact' %}">Contact</a></li>
          {% if user.is_authenticated %}
            <li><a href="{% url 'academy:account' %}">My Account</a></li>
            <li><a href="{% url 'academy:logout' %}">Log Out</a></li>
          {% else %}
            <li><a href="{% url 'academy:login' %}">Sign In</a></li>
            <li><a href="{% url 'academy:signup' %}">Sign Up</a></li>
          {% endif %}
        </ul>
      </nav>
    </header>

  <main class="container py-5">
    <h2 class="text-center mb-5 fw-bold">Welcome to OGA Academy</h2>

    <div class="row row-cols-1 row-cols-md-2 g-4">
      {% comment %}
        We expect `progress_data` to be a list of dicts:
          [{'lesson': <Lesson obj>, 'progress': 0-100}, …]
      {% endcomment %}

      {% for item in progress_data %}
        <div class="col">
          <div class="card border-0 shadow-sm rounded-4 h-100">
            <div class="card-body p-4 d-flex flex-column justify-content-between">
              
              <div>
                <div class="module-header">
                  Module {{ item.lesson.order }}: {{ item.lesson.title }}
                </div>
                <p class="text-muted small mb-2">
                  {{ item.lesson.title|truncatechars:40 }}
                </p>
              </div>

              <!-- Enhanced progress bar -->
              <div class="mb-3">
                <div class="progress" style="height: 6px;">
                  <div
                    class="progress-bar bg-primary rounded-pill progress-bar-striped progress-bar-animated"
                    role="progressbar"
                    style="width: {{ item.progress }}%;"
                    aria-valuenow="{{ item.progress }}"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
                <small class="text-muted">{{ item.progress }}% complete</small>
              </div>

              <a href="{% url 'academy:lesson_detail' lesson_id=item.lesson.id %}"
                 class="btn btn-primary w-100 rounded-pill">
                Continue Module
              </a>
            </div>
          </div>
        </div>
      {% endfor %}

    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-column">
        <h4>Quick Links</h4>
        <a href="{% url 'home' %}">Home</a>
        <a href="{% url 'about' %}">About Us</a>
        <a href="{% url 'publications' %}">Publications</a>
        <a href="{% url 'projects' %}">Projects</a>
        <a href="{% url 'news' %}">News</a>
        <a href="{% url 'contact' %}">Contact</a>
      </div>
      <div class="footer-column">
        <h4>Contact Us</h4>
        <p>Email: onlygoodantibodies@gmail.com</p>
        <p><a href="https://www.linkedin.com/company/onlygoodantibodies-community-and-forum/posts/?feedView=all" target="_blank">LinkedIn</a></p>
        <p><a href="https://bsky.app/profile/oga-community.bsky.social" target="_blank">BlueSky</a></p>
      </div>
      <div class="footer-column">
        <h4>Follow Us</h4>
        <a href="https://www.linkedin.com/company/onlygoodantibodies-community-and-forum/posts/?feedView=all" target="_blank">
          <img src="{% static 'core/linkedin-logo.webp' %}" alt="LinkedIn" class="social-icon">
        </a>
        <a href="https://bsky.app/profile/oga-community.bsky.social" target="_blank">
          <img src="{% static 'core/bluesky.png' %}" alt="BlueSky" class="social-icon">
        </a>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; {{ now|date:"Y" }} Only Good Antibodies Community. All Rights Reserved.</p>
      <button onclick="window.scrollTo({top: 0, behavior: 'smooth'});" class="back-to-top">Back to Top</button>
    </div>
  </footer>
</body>
</html>
